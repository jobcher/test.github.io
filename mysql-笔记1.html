<!DOCTYPE html>
<html lang="zh">

<head>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<link media="all" rel="stylesheet" href="./css/style.css">

<script src="./js/style.js"></script>



    <title>mysql 笔记（1） - 打工人日志</title>
</head>

<body>
    <div class="header-box">
    <img src="https://test.jobcher.com/images/logo.webp" id="logo" alt="logo" class="logo">
    <h1><a href="https://test.jobcher.com">打工人日志</a></h1>
</div>
<nav class="nav">
    <ul>
        
            <li>
                <a href="./">首页</a>
                
            </li>
        
            <li>
                <a href="https://nav.jobcher.com/">导航</a>
                
            </li>
        
            <li>
                <a href="./%E5%85%B3%E4%BA%8E%E6%88%91.html">关于</a>
                
            </li>
        
    </ul>
</nav>
    <div id="post" class="post">
        <header>
            <h2 class="post-title">mysql 笔记（1）</h2>
            
        </header>
        <article class="article">
                <div class="single-content">
                    <h1 id="mysql-学习笔记1">mysql 学习笔记（1）</h1>
<p>本文章不涉及到关于 mysql 开放上的问题，主要记录关于 mysql 出现的问题，以及如何去维护 mysql 数据的日常。</p>
<h2 id="mysql-各类信息的收集">mysql 各类信息的收集</h2>
<ol>
<li>收集变量信息</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">show</span> <span style="color:#66d9ef">global</span> variables;
</span></span></code></pre></div><ol start="2">
<li>收集进程信息</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">show</span> PROCESSLIST;
</span></span></code></pre></div><ol start="3">
<li>收集错误日志</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">show</span> <span style="color:#66d9ef">global</span> variables <span style="color:#66d9ef">like</span> <span style="color:#e6db74">&#39;log_error&#39;</span>;
</span></span></code></pre></div><ol start="4">
<li>收集慢日志信息</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">show</span> <span style="color:#66d9ef">global</span> variables <span style="color:#66d9ef">like</span> <span style="color:#e6db74">&#39;slow_querry_log_file&#39;</span>;
</span></span></code></pre></div><ol start="5">
<li>收集锁信息，高峰时期运行三次，每次间隔 10s</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span>  locked_table,
</span></span><span style="display:flex;"><span>        locked_index,
</span></span><span style="display:flex;"><span>        locked_type,
</span></span><span style="display:flex;"><span>        blocking_pid,
</span></span><span style="display:flex;"><span>        T2.<span style="color:#66d9ef">USER</span>  blocking_user,
</span></span><span style="display:flex;"><span>        T2.<span style="color:#66d9ef">HOST</span> blocking_host,
</span></span><span style="display:flex;"><span>        blocking_lock_mode,
</span></span><span style="display:flex;"><span>        blocking_trx_rows_modified,
</span></span><span style="display:flex;"><span>        waiting_pid,
</span></span><span style="display:flex;"><span>        T3.<span style="color:#66d9ef">USER</span> waiting_user,
</span></span><span style="display:flex;"><span>        T3.<span style="color:#66d9ef">HOST</span> waiting_host,
</span></span><span style="display:flex;"><span>        waiting_lock_mode,
</span></span><span style="display:flex;"><span>        waiting_trx_row_modified,
</span></span><span style="display:flex;"><span>        wait_age_secs,
</span></span><span style="display:flex;"><span>        waiting_query
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> sys.x$innodb_lock_waits T1
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">LEFT</span> <span style="color:#66d9ef">JOIN</span> INFROMATION_SCHEMA.processlist T2 <span style="color:#66d9ef">ON</span> T1.blocking_pid<span style="color:#f92672">=</span>T2.ID
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">LEFT</span> <span style="color:#66d9ef">JOIN</span> INFROMATION_SCHEMA.processlist T3 <span style="color:#66d9ef">ON</span> T3.ID<span style="color:#f92672">=</span>T1.waiting_pid;
</span></span></code></pre></div><ol start="6">
<li>收集 mysql 状态信息</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">show</span> <span style="color:#66d9ef">global</span> status;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">show</span> engine innodb status;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">show</span> engine innodb mutex;
</span></span></code></pre></div><h2 id="mysql-基础语法">mysql 基础语法</h2>
<ol>
<li>连接数据库</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>mysql <span style="color:#f92672">-</span>u <span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">用户名</span><span style="color:#f92672">&gt;</span> <span style="color:#f92672">-</span>p
</span></span></code></pre></div><ol start="2">
<li>创建数据库</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">CREATE</span> <span style="color:#66d9ef">DATABASE</span> <span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">数据库名称</span><span style="color:#f92672">&gt;</span>;
</span></span></code></pre></div><ol start="3">
<li>删除数据库</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">drop</span> <span style="color:#66d9ef">database</span> <span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">数据库名称</span><span style="color:#f92672">&gt;</span>;
</span></span></code></pre></div><ol start="4">
<li>选择数据库</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>use <span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">数据库名称</span><span style="color:#f92672">&gt;</span>;
</span></span></code></pre></div><ol start="5">
<li>创建表</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">CREATE</span> <span style="color:#66d9ef">table</span> <span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">数据表名</span><span style="color:#f92672">&gt;</span> (
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">字段名</span><span style="color:#ae81ff">1</span><span style="color:#f92672">&gt;</span> <span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">数据类型</span><span style="color:#f92672">&gt;</span> [<span style="color:#960050;background-color:#1e0010">约束条件</span>],
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">字段名</span><span style="color:#ae81ff">2</span><span style="color:#f92672">&gt;</span> <span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">数据类型</span><span style="color:#f92672">&gt;</span> [<span style="color:#960050;background-color:#1e0010">约束条件</span>],
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">字段名</span><span style="color:#ae81ff">3</span><span style="color:#f92672">&gt;</span> <span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">数据类型</span><span style="color:#f92672">&gt;</span> [<span style="color:#960050;background-color:#1e0010">约束条件</span>]
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span><span style="color:#f92672">#</span><span style="color:#960050;background-color:#1e0010">例如</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">CREATE</span> <span style="color:#66d9ef">TABLE</span> <span style="color:#66d9ef">IF</span> <span style="color:#66d9ef">NOT</span> <span style="color:#66d9ef">EXISTS</span> <span style="color:#f92672">`</span>nbtyfood_tbl<span style="color:#f92672">`</span>(
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">`</span>nbtyfood_id<span style="color:#f92672">`</span> INT UNSIGNED AUTO_INCREMENT,
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">`</span>nbtyfood_title<span style="color:#f92672">`</span> VARCHAR(<span style="color:#ae81ff">100</span>) <span style="color:#66d9ef">NOT</span> <span style="color:#66d9ef">NULL</span>,
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">`</span>nbtyfood_author<span style="color:#f92672">`</span> VARCHAR(<span style="color:#ae81ff">40</span>) <span style="color:#66d9ef">NOT</span> <span style="color:#66d9ef">NULL</span>,
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">`</span>submission_date<span style="color:#f92672">`</span> DATE,
</span></span><span style="display:flex;"><span>   <span style="color:#66d9ef">PRIMARY</span> <span style="color:#66d9ef">KEY</span> ( <span style="color:#f92672">`</span>nbtyfood_id<span style="color:#f92672">`</span> )
</span></span><span style="display:flex;"><span>)ENGINE<span style="color:#f92672">=</span>InnoDB <span style="color:#66d9ef">DEFAULT</span> CHARSET<span style="color:#f92672">=</span>utf8;
</span></span></code></pre></div><ol start="6">
<li>删除表</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">DROP</span> <span style="color:#66d9ef">TABLE</span> <span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">数据表名</span><span style="color:#f92672">&gt;</span>;
</span></span></code></pre></div><ol start="7">
<li>插入数据</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">INSERT</span> <span style="color:#66d9ef">INTO</span> <span style="color:#66d9ef">table_name</span> ( field1, field2,...fieldN )
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">VALUES</span>
</span></span><span style="display:flex;"><span>value1, value2,...valueN );
</span></span></code></pre></div><ol start="8">
<li>更新数据</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">UPDATE</span> <span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">数据表名</span><span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">SET</span> <span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">字段名</span><span style="color:#ae81ff">1</span><span style="color:#f92672">&gt;=</span><span style="color:#e6db74">&#39;更新&#39;</span> <span style="color:#66d9ef">WHERE</span> <span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">字段名</span><span style="color:#ae81ff">2</span><span style="color:#f92672">&gt;=</span><span style="color:#ae81ff">3</span>;
</span></span></code></pre></div><ol start="9">
<li>删除数据</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">DELETE</span> <span style="color:#66d9ef">FROM</span> <span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">数据表名</span><span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">WHERE</span> <span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">字段名</span><span style="color:#ae81ff">2</span><span style="color:#f92672">&gt;=</span><span style="color:#ae81ff">3</span>;
</span></span></code></pre></div><ol start="10">
<li>查询数据</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">select</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">from</span> <span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">数据表名</span><span style="color:#f92672">&gt;</span>;
</span></span></code></pre></div>
                </div>
            <br />
        <div>
                
                <a href="https://test.jobcher.com/linux%E7%B3%BB%E7%BB%9F%E5%BC%80%E5%90%AFroot%E6%9D%83%E9%99%90.html" class="prev">前一页</a>
                
                
                <a href="https://test.jobcher.com/163%E4%BC%81%E4%B8%9A%E9%82%AE%E7%AE%B1%E8%AE%BE%E7%BD%AE%E6%95%99%E7%A8%8B.html" class="next">后一页</a>
                
            </div>
        </article>
    </div>

    <nav class="footer-nav">
        <ul>
            
            <li><a href="./%E5%85%B3%E4%BA%8E%E6%88%91.html">关于我们</a></li>
            
            <li><a href="./">网站首页</a></li>
            
            <li><a href=""></a></li>
            
        </ul>
    </nav>
    <footer class="footer">
    <span style="color: aliceblue;">© 2019-2023 by jobcher</span>
</footer>
</body>

</html>