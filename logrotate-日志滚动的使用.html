<!DOCTYPE html>
<html lang="zh">

<head>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<link media="all" rel="stylesheet" href="./css/style.css">

<script src="./js/style.js"></script>



    <title>logrotate 日志滚动的使用 - 打工人日志</title>
</head>

<body>
    <div class="header-box">
    <img src="https://test.jobcher.com/images/logo.webp" id="logo" alt="logo" class="logo">
    <h1><a href="https://test.jobcher.com">打工人日志</a></h1>
</div>
<nav class="nav">
    <ul>
        
            <li>
                <a href="./">首页</a>
                
            </li>
        
            <li>
                <a href="https://nav.jobcher.com/">导航</a>
                
            </li>
        
            <li>
                <a href="./posts/about">关于</a>
                
            </li>
        
    </ul>
</nav>
    <div id="post" class="post">
        <header>
            <h2 class="post-title">logrotate 日志滚动的使用</h2>
            
        </header>
        <article class="article">
                <div class="single-content">
                    <h1 id="logrotate-日志滚动的使用">logrotate 日志滚动的使用</h1>
<p>logrotate 日志滚动切割工具，是 linux 默认安装的工具，配置文件位置：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>/etc/logrotate.conf
</span></span><span style="display:flex;"><span>/etc/logrotate.d/
</span></span></code></pre></div><h2 id="参数">参数</h2>
<p>以 nginx 配置为例</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>/opt/log/nginx/*.log <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>	daily
</span></span><span style="display:flex;"><span>	missingok
</span></span><span style="display:flex;"><span>	rotate <span style="color:#ae81ff">14</span>
</span></span><span style="display:flex;"><span>    errors <span style="color:#e6db74">&#34;nb@nbtyfood.com&#34;</span>
</span></span><span style="display:flex;"><span>	compress
</span></span><span style="display:flex;"><span>	delaycompress
</span></span><span style="display:flex;"><span>	notifempty
</span></span><span style="display:flex;"><span>	create <span style="color:#ae81ff">0640</span> www-data adm
</span></span><span style="display:flex;"><span>	sharedscripts
</span></span><span style="display:flex;"><span>	prerotate
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> -d /etc/logrotate.d/httpd-prerotate <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>			run-parts /etc/logrotate.d/httpd-prerotate; <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>		<span style="color:#66d9ef">fi</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>	endscript
</span></span><span style="display:flex;"><span>	postrotate
</span></span><span style="display:flex;"><span>		invoke-rc.d nginx rotate &gt;/dev/null 2&gt;&amp;<span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>	endscript
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><table>
<thead>
<tr>
<th style="text-align:left">参数</th>
<th style="text-align:left">作用</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">compress</td>
<td style="text-align:left">压缩日志文件的所有非当前版本</td>
</tr>
<tr>
<td style="text-align:left">daily,weekly,monthly</td>
<td style="text-align:left">按指定计划轮换日志文件</td>
</tr>
<tr>
<td style="text-align:left">delaycompress</td>
<td style="text-align:left">压缩所有版本，除了当前和下一个最近的</td>
</tr>
<tr>
<td style="text-align:left">endscript</td>
<td style="text-align:left">标记 prerotate 或 postrotate 脚本的结束</td>
</tr>
<tr>
<td style="text-align:left">errors &ldquo;emailid&rdquo;</td>
<td style="text-align:left">给指定邮箱发送错误通知</td>
</tr>
<tr>
<td style="text-align:left">missingok</td>
<td style="text-align:left">如果日志文件丢失，不要显示错误</td>
</tr>
<tr>
<td style="text-align:left">notifempty</td>
<td style="text-align:left">如果日志文件为空，则不轮换日志文件</td>
</tr>
<tr>
<td style="text-align:left">olddir &ldquo;dir&rdquo;</td>
<td style="text-align:left">指定日志文件的旧版本放在 “dir” 中</td>
</tr>
<tr>
<td style="text-align:left">postrotate</td>
<td style="text-align:left">引入一个在日志被轮换后执行的脚本</td>
</tr>
<tr>
<td style="text-align:left">prerotate</td>
<td style="text-align:left">引入一个在日志被轮换前执行的脚本</td>
</tr>
<tr>
<td style="text-align:left">rotate &rsquo;n'</td>
<td style="text-align:left">在轮换方案中包含日志的 n 个版本</td>
</tr>
<tr>
<td style="text-align:left">sharedscripts</td>
<td style="text-align:left">对于整个日志组只运行一次脚本</td>
</tr>
<tr>
<td style="text-align:left">size=&lsquo;logsize&rsquo;</td>
<td style="text-align:left">在日志大小大于 logsize（例如 100K，4M）时轮换</td>
</tr>
</tbody>
</table>

                </div>
            <br />
        <div>
                
                <a href="https://test.jobcher.com/yaml-%E8%AF%AD%E6%B3%95.html" class="prev">前一页</a>
                
                
                <a href="https://test.jobcher.com/docker-%E5%91%BD%E4%BB%A4.html" class="next">后一页</a>
                
            </div>
        </article>
    </div>

    <nav class="footer-nav">
        <ul>
            
            <li><a href="./posts/about">关于我们</a></li>
            
            <li><a href="./">网站首页</a></li>
            
            <li><a href=""></a></li>
            
        </ul>
    </nav>
    <footer class="footer">
    <span style="color: aliceblue;">© 2019-2023 by jobcher</span>
</footer>
</body>

</html>