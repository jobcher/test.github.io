<!DOCTYPE html>
<html lang="zh">

<head>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<link media="all" rel="stylesheet" href="./css/style.css">
<link media="all" rel="stylesheet" href="./css/search.css">

<script src="./js/style.js"></script>



    <title>git版本控制 - 打工人日志</title>
</head>

<body>
    <div class="header-box">
    <img src="https://test.jobcher.com/images/logo.webp" id="logo" alt="logo" class="logo">
    <h1><a href="https://test.jobcher.com">打工人日志</a></h1>
</div>
<nav class="nav">
    <ul>
        
            <li>
                <a href="./">首页</a>
                
            </li>
        
            <li>
                <a href="https://test.jobcher.com/">日报</a>
                
            </li>
        
            <li>
                <a href="https://nav.jobcher.com/">导航</a>
                
            </li>
        
            <li>
                <a href="./%E5%85%B3%E4%BA%8E%E6%88%91.html">关于</a>
                
            </li>
        
    </ul>
</nav>
    <div id="post" class="post">
        <header>
            <h2 class="post-title">git版本控制</h2>
            
        </header>
        <article class="article">
                <div class="single-content">
                    <h1 id="git-版本控制">git 版本控制</h1>
<h2 id="版本回退">版本回退</h2>
<h3 id="1查看-git-提交历史">1.查看 git 提交历史</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span><span style="color:#75715e">#查看git提交历史</span>
</span></span><span style="display:flex;"><span>git log
</span></span></code></pre></div><p><img src="./images/git2-1.png" alt="git2-1"><br>
如果嫌输出信息太多，看得眼花缭乱的，可以试试加上<code>--pretty=oneline</code>参数</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>git log --pretty<span style="color:#f92672">=</span>oneline
</span></span></code></pre></div><h3 id="2回退到上一个版本">2.回退到上一个版本</h3>
<p><code>Git</code>必须知道当前版本是哪个版本，在 Git 中，用<code>HEAD</code>表示当前版本，也就是最新的提交<code>b534d741..</code>（注意我的提交 ID 和你的肯定不一样），上一个版本就是<code>HEAD^</code>，上上一个版本就是<code>HEAD^^</code>，当然往上 100 个版本写 100 个^比较容易数不过来，所以写成<code>HEAD~100</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>git reset --hard HEAD^
</span></span></code></pre></div><p>最新的那个版本已经看不到了，可以顺着往上找，找到那个版本的 ID</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>git reset --hard c8275ca
</span></span></code></pre></div><p>Git 在内部有个指向当前版本的<code>HEAD</code>指针,当你回退版本的时候，Git 仅仅是把<code>HEAD</code>从指向<code>update</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌────┐
</span></span><span style="display:flex;"><span>│HEAD│
</span></span><span style="display:flex;"><span>└────┘
</span></span><span style="display:flex;"><span>   │
</span></span><span style="display:flex;"><span>   └──&gt; ○ update
</span></span><span style="display:flex;"><span>        │
</span></span><span style="display:flex;"><span>        ○ Create README.md
</span></span><span style="display:flex;"><span>        │
</span></span><span style="display:flex;"><span>        ○ init
</span></span></code></pre></div><p>改为指向 Create README.md：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌────┐
</span></span><span style="display:flex;"><span>│HEAD│
</span></span><span style="display:flex;"><span>└────┘
</span></span><span style="display:flex;"><span>   │
</span></span><span style="display:flex;"><span>   │    ○ update
</span></span><span style="display:flex;"><span>   │    │
</span></span><span style="display:flex;"><span>   └──&gt; ○ Create README.md
</span></span><span style="display:flex;"><span>        │
</span></span><span style="display:flex;"><span>        ○ init
</span></span></code></pre></div><p>现在，你回退到了某个版本，关掉了电脑，第二天早上就后悔了，想恢复到新版本怎么办？找不到新版本的<code>commit id</code>怎么办？<br>
在 Git 中，总是有后悔药可以吃的。当你用$ <code>git reset --hard HEAD^</code>回退到<code>Create README.md</code>版本时，再想恢复到<code>update</code>，就必须找到<code>update</code>的 commit id。Git 提供了一个命令<code>git reflog</code>用来记录你的每一次命令：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>git reflog
</span></span></code></pre></div><h3 id="3总结一下">3.总结一下：</h3>
<ol>
<li><code>HEAD</code>指向的版本就是当前版本，因此，Git 允许我们在版本的历史之间穿梭，使用命令<code>git reset --hard commit_id</code>。</li>
<li>穿梭前，用<code>git log</code>可以查看提交历史，以便确定要回退到哪个版本。</li>
<li>要重返未来，用<code>git reflog</code>查看命令历史，以便确定要回到未来的哪个版本。</li>
</ol>
<h2 id="工作区和暂存区">工作区和暂存区</h2>
<p><code>工作区</code>（Working Directory）<br>
就是你在电脑里能看到的目录，比如我的<code>shell</code>文件夹就是一个工作区<br>
<code>版本库</code>（Repository）<br>
工作区有一个隐藏目录.git，这个不算工作区，而是 Git 的版本库。</p>
<h2 id="管理修改">管理修改</h2>
<p>那怎么提交第二次修改呢？你可以继续<code>git add</code>再<code>git commit</code>，也可以别着急提交第一次修改，先 git add 第二次修改，再<code>git commit</code>，就相当于把两次修改合并后一块提交了：</p>
<p>第一次修改 -&gt; <code>git add</code> -&gt; 第二次修改 -&gt; <code>git add</code> -&gt; <code>git commit </code></p>
<p>现在，你又理解了<code>Git</code>是如何跟踪修改的，每次修改，如果不用<code>git add</code>到暂存区，那就不会加入到<code>commit</code>中。</p>
<h2 id="撤销修改">撤销修改</h2>
<p><code>git checkout -- file</code>可以丢弃工作区的修改</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>git checkout -- readme.txt
</span></span></code></pre></div><p>命令<code>git checkout -- readme.txt</code>意思就是，把<code>readme.txt</code>文件在工作区的修改全部撤销，这里有两种情况：<br>
一种是<code>readme.txt</code>自修改后还没有被放到暂存区，现在，撤销修改就回到和版本库一模一样的状态；</p>
<p>一种是<code>readme.txt</code>已经添加到暂存区后，又作了修改，现在，撤销修改就回到添加到暂存区后的状态。</p>
<p>总之，就是让这个文件回到最近一次<code>git commit</code>或<code>git add</code>时的状态。</p>
<p><code>git checkout -- file</code>命令中的<code>--</code>很重要，没有<code>--</code>，就变成了“切换到另一个分支”的命令，我们在后面的分支管理中会再次遇到<code>git checkout</code>命令。</p>
<h2 id="删除文件">删除文件</h2>

                </div>
            <br />
        <div>
                
                <a href="https://test.jobcher.com/ruoyi-cloud-docker%E9%83%A8%E7%BD%B2.html" class="prev">前一页</a>
                
                
                <a href="https://test.jobcher.com/linux-crontab-%E5%91%BD%E4%BB%A4.html" class="next">后一页</a>
                
            </div>
        </article>
    </div>

    <nav class="footer-nav">
        <ul>
            
            <li><a href="./%E5%85%B3%E4%BA%8E%E6%88%91.html">关于我们</a></li>
            
            <li><a href="./">网站首页</a></li>
            
            <li><a href=""></a></li>
            
        </ul>
    </nav>
    <footer class="footer">
    <span style="color: aliceblue;">© 2019-2023 by jobcher</span>
</footer>
</body>

</html>